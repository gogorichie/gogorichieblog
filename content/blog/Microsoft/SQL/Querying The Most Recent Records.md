---
title: "Querying The Most Recent Records"
date: 2012-11-13
draft: false
tags: ["SQL"]
---

Here’s another fun solution for you business intelligence people out there. Suppose you wanted to pull data that was updated in the last 15mins based on when a row was last. I'm sure there are many ways to accomplish this but I like to use the [DATEADD() function](http://msdn.microsoft.com/en-us/library/ms186819.aspx) in Microsoft SQL Server 2008\. Below is the query using the [AdventureWorks2008R2](http://msftdbprodsamples.codeplex.com/) database enjoy.

<span style="font-family: Lucida Console; font-size: 10pt;"><span style="color: blue;">SELECT</span> I<span style="color: gray;">.</span>ProductID<span style="color: gray;">,</span> I<span style="color: gray;">.</span>LocationID<span style="color: gray;">,</span> I<span style="color: gray;">.</span>Bin<span style="color: gray;">,</span> I<span style="color: gray;">.</span>Shelf<span style="color: gray;">,</span> I<span style="color: gray;">.</span>Quantity<span style="color: gray;">,</span> P<span style="color: gray;">.</span>ProductNumber<span style="color: gray;">,</span> P<span style="color: gray;">.</span>Name<span style="color: gray;">,</span> I<span style="color: gray;">.</span>ModifiedDate</span>

<span style="color: blue;">FROM</span> <span style="font-family: 'Lucida Console'; font-size: 10pt;">AdventureWorks2008R2</span><span style="color: gray;">.</span><span style="font-family: 'Lucida Console'; font-size: 10pt;">Production</span><span style="color: gray;">.</span><span style="font-family: 'Lucida Console'; font-size: 10pt;">ProductInventory</span> <span style="color: blue;">AS</span> <span style="font-family: 'Lucida Console'; font-size: 10pt;">I</span> <span style="color: gray;">LEFT</span><span style="color: gray;"> </span><span style="color: gray;">OUTER</span><span style="color: gray;"> </span><span style="color: gray;">JOIN </span><span style="font-family: 'Lucida Console'; font-size: 10pt;">AdventureWorks2008R2</span><span style="color: gray;">.</span><span style="font-family: 'Lucida Console'; font-size: 10pt;">Production</span><span style="color: gray;">.</span><span style="font-family: 'Lucida Console'; font-size: 10pt;">Product</span> <span style="color: blue;">AS</span> <span style="font-family: 'Lucida Console'; font-size: 10pt;">P</span> <span style="color: blue;">ON</span> <span style="font-family: 'Lucida Console'; font-size: 10pt;">I</span><span style="color: gray;">.</span><span style="font-family: 'Lucida Console'; font-size: 10pt;">ProductID</span> <span style="color: gray;">=</span> <span style="font-family: 'Lucida Console'; font-size: 10pt;">P</span><span style="color: gray;">.</span><span style="font-family: 'Lucida Console'; font-size: 10pt;">ProductID</span>

<span style="font-family: Lucida Console; font-size: 10pt;"><span style="color: #0000ff;">WHERE</span> <span style="color: gray;">(</span><span style="color: #0000ff;">I</span><span style="color: gray;">.</span><span style="color: #0000ff;">ModifiedDate</span> <span style="color: gray;">>=</span><span style="color: #0000ff;"> </span><span style="color: #ff00ff;">REPLACE</span><span style="color: #808080;">(</span><span style="color: #ff00ff;">CONVERT</span><span style="color: #808080;">(</span><span style="color: #0000ff;">VARCHAR</span><span style="color: gray;">(</span><span style="color: #0000ff;">19</span><span style="color: gray;">),</span><span style="color: #0000ff;"> </span><span style="color: fuchsia;">DATEADD<span style="color: gray;">(<span style="color: blue;">minute<span style="color: gray;">,</span><span style="color: gray;">-</span>30<span style="color: gray;">,</span><span style="color: fuchsia;">GETDATE<span style="color: gray;">()),</span> 120<span style="color: gray;">),</span><span style="color: red;">'-'<span style="color: gray;">,</span> '/'<span style="color: gray;">))</span></span></span></span></span></span></span>

<!-- ![](http://www.gogorichie.com/wp-content/uploads/2012/11/111312_1952_QueryingThe1.png) -->

P.S. Before the query in the example will work on the AdventureWorks database you'll need to update a couple of rows on the <span style="font-family: Lucida Console; font-size: 10pt;">ProductInventory table.</span>
